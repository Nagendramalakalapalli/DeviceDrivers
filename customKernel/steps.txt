#!/bin/bash
sudo apt-get update
sudo apt install qemu-system-arm
sudo apt install libncurses-dev flex bison
sudo apt install libssl-dev
sudo apt install gcc-arm-linux-gnueabi

#Download kernel
wget https://cdn.kernel.org/pub/linux/kernel/v6.x/linux-6.1.4.tar.xz
#For Unzipping the file
tar xvf ../customKernel/linux-6.1.4.tar.xz
make ARCH=arm vexpress_defconfig #from here do it in linux-6.1.4 folder
make ARCH=arm menuconfig
make ARCH=arm CROSS_COMPILE=arm-linux-gnueabi-
cp linux-6.1.4/arch/arm/boot/zImage /home/praveen/DeviceDrivers/customKernel
cp linux-6.1.4/arch/arm/boot/dts/vexpress-v2p-ca9.dtb /home/DeviceDrivers/customKernel/

#Lanch qemu
qemu-system-arm -M vexpress-a9 -m 1024 -nographic -kernel zImage -dtb vexpress-v2p-ca9.dtb -sd rootfs.img -append "console=ttyAMA0 root=/dev/mmcblk0 rw"
